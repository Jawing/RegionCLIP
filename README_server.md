this branch is only used for server inference